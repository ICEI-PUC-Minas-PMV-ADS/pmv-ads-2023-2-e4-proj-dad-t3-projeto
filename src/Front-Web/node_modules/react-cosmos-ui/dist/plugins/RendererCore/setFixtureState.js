import { postSetFixtureStateRequest } from './shared/postRequest.js';
import { getSelectedFixtureId } from './shared/router.js';
export function setFixtureState(context, stateUpdater) {
    const fixtureId = getSelectedFixtureId(context);
    if (!fixtureId) {
        console.warn('[Renderer] Trying to set fixture state with no fixture selected');
        return;
    }
    context.setState(change, () => {
        postRendererRequest(fixtureId);
    });
    function change(prevState) {
        return {
            ...prevState,
            fixtureState: stateUpdater(prevState.fixtureState),
        };
    }
    function postRendererRequest(selectedFixtureId) {
        const { connectedRendererIds, fixtureState } = context.getState();
        connectedRendererIds.forEach(rendererId => postSetFixtureStateRequest(context, rendererId, selectedFixtureId, fixtureState));
    }
}
